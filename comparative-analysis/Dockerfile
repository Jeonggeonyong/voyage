# 1. Node.js 18-alpine ë²„ì „ì„ ê¸°ë°˜ìœ¼ë¡œ ì´ë¯¸ì§€ë¥¼ ë§Œë“­ë‹ˆë‹¤.
FROM node:18-alpine

# 2. ì»¨í…Œì´ë„ˆ ë‚´ë¶€ì— ì‘ì—… í´ë”ë¥¼ /usr/src/appìœ¼ë¡œ ì„¤ì •í•©ë‹ˆë‹¤.
WORKDIR /usr/src/app

# 3. ì˜ì¡´ì„± íŒŒì¼ë“¤ì„ ë¨¼ì € ë³µì‚¬í•˜ê³  ì„¤ì¹˜í•˜ì—¬ ìºì‹±ì„ í™œìš©í•©ë‹ˆë‹¤.
COPY package.json package-lock.json* ./

# 4. ì˜ì¡´ì„±ì„ ì„¤ì¹˜í•©ë‹ˆë‹¤.
# (í”„ë¡œë•ì…˜ìš© ì˜ì¡´ì„±ë§Œ ì„¤ì¹˜í•˜ì—¬ ì´ë¯¸ì§€ ê²½ëŸ‰í™”)
RUN npm install --omit=dev

# 5. ì†ŒìŠ¤ ì½”ë“œì™€ í•„ìš”í•œ ëª¨ë“ˆì„ ë³µì‚¬í•©ë‹ˆë‹¤.

# 5a. comparative-analysis ì„œë²„ íŒŒì¼ ë³µì‚¬ (ì†ŒìŠ¤ ê²½ë¡œ ìœ ì§€)
COPY comparative-analysis/comparative-analysis.js ./

# 5b. DB ëª¨ë“ˆ ë³µì‚¬: comparative-analysis í´ë”ì—ì„œ ê°€ì ¸ì™€ì„œ ë£¨íŠ¸ì— ë³µì‚¬í•©ë‹ˆë‹¤.
# (ì†ŒìŠ¤: comparative-analysis/db.js, ëŒ€ìƒ: ./db.js)
COPY comparative-analysis/db.js ./db.js
# .env íŒŒì¼ ë³µì‚¬ (DB ì ‘ì† ì •ë³´ ë¡œë“œë¥¼ ìœ„í•´)
# ğŸ’¡ ì´ ë¼ì¸ì„ ì œê±°í•˜ì—¬ í´ë¼ìš°ë“œ Secret/ConfigMapìœ¼ë¡œ í™˜ê²½ ë³€ìˆ˜ë¥¼ ì£¼ì…í•©ë‹ˆë‹¤.


# 6. ì•±ì´ 3000ë²ˆ í¬íŠ¸ë¥¼ ì‚¬ìš©í•œë‹¤ê³  ëª…ì‹œí•©ë‹ˆë‹¤.
EXPOSE 3000

# 7. ì»¨í…Œì´ë„ˆê°€ ì‹œì‘ë  ë•Œ "node comparative-analysis.js" ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤.
CMD [ "node", "comparative-analysis.js" ]
